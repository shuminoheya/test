<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>フォルダ選択テスト</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2em;
      background: #f0f4f8;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      margin-top: 10px;
    }
    #status {
      margin-top: 1em;
      color: #333;
    }
  </style>
</head>
<body>
  <h2>フォルダ選択テスト</h2>
  <button id="selectFolder">保存先フォルダを選ぶ</button>
  <p id="status">待機中...</p>

  <script>
    let folderHandle = null;

    document.getElementById('selectFolder').addEventListener('click', async () => {
      const status = document.getElementById('status');

      if (!window.showDirectoryPicker) {
        status.textContent = 'このブラウザはフォルダ選択に対応していません。';
        return;
      }

      try {
        folderHandle = await window.showDirectoryPicker();
        status.textContent = 'フォルダが選択されました。';
        
        // テスト：その中にファイルを書き込んでみる
        const fileHandle = await folderHandle.getFileHandle('test-output.txt', { create: true });
        const writable = await fileHandle.createWritable();
        await writable.write('これはテスト出力です。');
        await writable.close();
        status.textContent += ' ファイル test-output.txt を保存しました。';
      } catch (err) {
        status.textContent = 'フォルダの選択がキャンセルされました。';
      }
    });
  </script>
</body>
</html>
